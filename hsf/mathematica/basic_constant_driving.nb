(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11210,        312]
NotebookOptionsPosition[      9763,        281]
NotebookOutlinePosition[     10116,        297]
CellTagsIndexPosition[     10073,        294]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Integration", " ", "of", " ", "Voltage", " ", "Potential"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.809869740861421*^9, 3.809869748655196*^9}, {
  3.809869816578106*^9, 3.809869821660265*^9}, {3.809870699540135*^9, 
  3.8098707011288767`*^9}, {3.809954372863741*^9, 
  3.809954388040462*^9}},ExpressionUUID->"1ad0e6fc-de0e-4fc3-8159-\
dd5d8e8541ce"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"v", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"l", "*", 
        RowBox[{"v", "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "+", "1"}], ")"}], 
        RowBox[{"s", "^", "2"}], "*", 
        RowBox[{"r", "[", "t", "]"}]}], "+", 
       RowBox[{"s", "*", "k"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"r", "'"}], "[", "t", "]"}], "+", 
       RowBox[{"r", "[", "t", "]"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"v", "[", "0", "]"}], "\[Equal]", "v0"}], ",", 
     RowBox[{
      RowBox[{"r", "[", "0", "]"}], "\[Equal]", "r0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", "t", "]"}], ",", 
     RowBox[{"r", "[", "t", "]"}]}], "}"}], ",", " ", "t"}], "]"}]}], "Input",\

 CellChangeTimes->{{3.8098688483031054`*^9, 3.809868856855661*^9}, {
   3.809868909677699*^9, 3.80986897626187*^9}, {3.809869015175956*^9, 
   3.809869063943267*^9}, {3.809869148394793*^9, 3.809869224178084*^9}, {
   3.809869267833729*^9, 3.80986927561567*^9}, {3.8098695863809443`*^9, 
   3.8098696416025667`*^9}, {3.809869690753585*^9, 3.8098697617713957`*^9}, {
   3.809869827546866*^9, 3.809869967315504*^9}, {3.809870027856023*^9, 
   3.809870066723023*^9}, {3.809870124939795*^9, 3.809870128250477*^9}, {
   3.809870245968095*^9, 3.8098702564537*^9}, {3.809870329766329*^9, 
   3.80987036820347*^9}, {3.8098704995488586`*^9, 3.809870519711625*^9}, 
   3.80987069516649*^9, {3.809870968775502*^9, 3.80987097489633*^9}, {
   3.809871038341728*^9, 3.8098710750366297`*^9}, {3.809871118888109*^9, 
   3.809871231627562*^9}, {3.809871297307849*^9, 3.809871324465736*^9}, {
   3.80987145067238*^9, 3.80987145225205*^9}, {3.8098714879004498`*^9, 
   3.809871549531105*^9}, {3.8098718844823637`*^9, 3.809871901480227*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"04705fcc-098f-4afb-9d09-3f1fad7fe7fb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", "t", "]"}], "\[Rule]", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", "t"}]], " ", "r0"}]}], ",", 
     RowBox[{
      RowBox[{"v", "[", "t", "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", "t"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", "t"]}], " ", "k", " ", "s"}], 
          "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"t", "+", 
             RowBox[{"l", " ", "t"}]}]], " ", "k", " ", "s"}], "-", 
          RowBox[{"l", " ", "r0", " ", 
           SuperscriptBox["s", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"t", "+", 
             RowBox[{"l", " ", "t"}]}]], " ", "l", " ", "r0", " ", 
           SuperscriptBox["s", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"t", "+", 
             RowBox[{"l", " ", "t"}]}]], " ", "l", " ", "v0"}]}], ")"}]}], 
       "l"]}]}], "}"}], "}"}], "/.", "\[VeryThinSpace]", 
  RowBox[{"Rule", "\[Rule]", "Equal"}]}]], "Input",
 NumberMarks->False,
 CellLabel->"In[1]:=",ExpressionUUID->"b353293b-f40d-4eb5-9409-176475e6dbff"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "t", "]"}], "\[Equal]", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "t"}]], " ", "r0"}]}], ",", 
    RowBox[{
     RowBox[{"v", "[", "t", "]"}], "\[Equal]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", "t"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["\[ExponentialE]", "t"]}], " ", "k", " ", "s"}], 
         "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"t", "+", 
            RowBox[{"l", " ", "t"}]}]], " ", "k", " ", "s"}], "-", 
         RowBox[{"l", " ", "r0", " ", 
          SuperscriptBox["s", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"t", "+", 
            RowBox[{"l", " ", "t"}]}]], " ", "l", " ", "r0", " ", 
          SuperscriptBox["s", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"t", "+", 
            RowBox[{"l", " ", "t"}]}]], " ", "l", " ", "v0"}]}], ")"}]}], 
      "l"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.8099545453170156`*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"81cb9eb0-718e-436b-b78c-d995413a1284"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Compute", " ", "Voltage", " ", "Firing", " ", "Rate", " ", "for", " ", 
    "Simple", " ", "Case"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "^", "2"}], "/", "2"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"e", "^", 
          RowBox[{"{", "lt", "}"}]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sk", "/", "l"}], " ", "-", 
           RowBox[{
            RowBox[{"s", "^", "2"}], "/", "2"}]}], ")"}]}], "-", 
        RowBox[{"s", " ", 
         RowBox[{"k", "/", "l"}]}]}]}], "}"}], ",", 
     RowBox[{"{", "t", "}"}]}], "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8099545507238293`*^9, 3.80995459065366*^9}, {
  3.809954658270567*^9, 3.8099546758074417`*^9}, {3.8099547085319242`*^9, 
  3.809954817884859*^9}},ExpressionUUID->"b7d2d26f-2d2f-4cec-bf9c-\
f1fef7a43179"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"x", "'"}], "[", "t", "]"}], "==", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"x", "[", "t", "]"}]}], "+", 
     RowBox[{"DiracDelta", "[", 
      RowBox[{"t", "-", "a"}], "]"}]}]}], ",", " ", 
   RowBox[{"x", "[", "t", "]"}], ",", " ", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.81014051247736*^9, 3.81014067396497*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"8848a289-6332-4cbe-b851-02eb73081e2d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "t"}]], " ", 
      RowBox[{"C", "[", "1", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"a", "-", "t"}]], " ", 
      RowBox[{"HeavisideTheta", "[", 
       RowBox[{
        RowBox[{"-", "a"}], "+", "t"}], "]"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.810140679416295*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"1b8a7710-c85f-4862-a9ad-95830759b257"],

Cell[BoxData[
 TemplateBox[{
  "DSolve","dvnoarg",
   "\"The function \\!\\(\\*RowBox[{\\\"x\\\"}]\\) appears with no arguments.\
\"",2,1,1,33043247168634397260,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.810140666461375*^9, 
  3.81014067648876*^9}},ExpressionUUID->"b1fd8931-c8bb-42fd-99eb-\
c955ffe51a5d"],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"-", "x"}], "+", 
     RowBox[{"DiracDelta", "[", 
      RowBox[{
       RowBox[{"-", "a"}], "+", "t"}], "]"}]}]}], ",", 
   RowBox[{"x", "[", "t", "]"}], ",", "t"}], "]"}]], "Output",
 CellChangeTimes->{3.810140666462109*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"04af8ca0-60b8-40e5-a7fc-0825975f35e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"d", " ", "=", " ", "2"}], "\[IndentingNewLine]", 
 RowBox[{"r0", " ", "=", " ", 
  RowBox[{"Array", "[", 
   RowBox[{"\[Lambda]", ",", " ", "d"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8101560881061163`*^9, 3.810156160283126*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"563fe34c-a458-4a71-896a-54dbc446bf2b"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.8101561461711283`*^9, 3.810156161433247*^9}},
 CellLabel->"Out[4]=",ExpressionUUID->"3650d86f-d4d5-4142-be3d-ea4f1d783195"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "[", "1", "]"}], ",", 
   RowBox[{"\[Lambda]", "[", "2", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8101561461711283`*^9, 3.8101561614379663`*^9}},
 CellLabel->"Out[5]=",ExpressionUUID->"ccfbbaf5-7d71-4ad5-a301-64bb721b2673"]
}, Open  ]]
},
WindowSize->{1684, 1372},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification->2.,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 394, 8, 61, "Input",ExpressionUUID->"1ad0e6fc-de0e-4fc3-8159-dd5d8e8541ce"],
Cell[955, 30, 2110, 46, 150, "Input",ExpressionUUID->"04705fcc-098f-4afb-9d09-3f1fad7fe7fb"],
Cell[CellGroupData[{
Cell[3090, 80, 1431, 40, 167, "Input",ExpressionUUID->"b353293b-f40d-4eb5-9409-176475e6dbff"],
Cell[4524, 122, 1342, 38, 139, "Output",ExpressionUUID->"81cb9eb0-718e-436b-b78c-d995413a1284"]
}, Open  ]],
Cell[5881, 163, 1005, 28, 150, "Input",ExpressionUUID->"b7d2d26f-2d2f-4cec-bf9c-f1fef7a43179"],
Cell[CellGroupData[{
Cell[6911, 195, 494, 13, 61, "Input",ExpressionUUID->"8848a289-6332-4cbe-b851-02eb73081e2d"],
Cell[7408, 210, 594, 17, 131, "Output",ExpressionUUID->"1b8a7710-c85f-4862-a9ad-95830759b257"],
Cell[8005, 229, 386, 10, 44, "Message",ExpressionUUID->"b1fd8931-c8bb-42fd-99eb-c955ffe51a5d"],
Cell[8394, 241, 504, 14, 69, "Output",ExpressionUUID->"04af8ca0-60b8-40e5-a7fc-0825975f35e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8935, 260, 337, 6, 106, "Input",ExpressionUUID->"563fe34c-a458-4a71-896a-54dbc446bf2b"],
Cell[9275, 268, 174, 2, 69, "Output",ExpressionUUID->"3650d86f-d4d5-4142-be3d-ea4f1d783195"],
Cell[9452, 272, 295, 6, 69, "Output",ExpressionUUID->"ccfbbaf5-7d71-4ad5-a301-64bb721b2673"]
}, Open  ]]
}
]
*)

